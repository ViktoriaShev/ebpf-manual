
На данный момент невозможно писать eBPF-программы на чистом Go, потому что: eBPF-программы должны быть скомпилированы в специфичный байткод, совместимый с ядром Linux. 
Такой байткод должен быть очень ограниченным: нельзя использовать динамическую память, циклы ограничены, нельзя вызывать произвольные функции и т.д. 
Компилятор Go просто не предназначен для генерации eBPF-байткода — этим занимается clang + llvm, который поддерживает -target bpf. Однако... Есть инициативы и проекты, которые упрощают взаимодействие Go с eBPF: 
1. [Cilium/ebpf](https://github.com/cilium/ebpf) — основная Go-библиотека для работы с eBPF Написана на чистом Go Позволяет загружать и взаимодействовать с eBPF-программами Используется в продакшене, например, в Cilium, Hubble и др. 
2. [Aya](https://github.com/aya-rs/aya) — в мире Rust есть уже полный стек eBPF-написания (и ядро, и userspace). Go до этого пока не дошёл.
3. Возможный workaround (но не полноценный Go eBPF) 
Существуют эксперименты, которые компилируют подмножество Go в eBPF (например, через WebAssembly -> eBPF), но:
Это экспериментально
Сильно ограничено 
Не подходит для продакшена 

Вывод Писать ядро eBPF-программы нужно на C или с помощью BPF CO-RE (или BPF assembler), а Go идеально подходит для пользовательского уровня: загрузка, работа с картами, событиями, отладка, и так далее. Хочешь, могу предложить шаблон проекта Go + eBPF, чтобы всё было на месте.

